this contains javascript code.
Here is the crucial part which is based on functionality.
Logic is important.